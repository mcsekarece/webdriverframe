package com.nexia.selenium.testscripts.section.portability;

import java.io.IOException;

import org.testng.Assert;
import org.testng.annotations.Parameters;
import org.testng.annotations.Test;
import com.nexia.selenium.genericlibrary.schedulingsettings.AbstractSchedulingTest;
import com.nexia.selenium.genericlibrary.schedulingsettings.SchedulingTestLib;

import com.thoughtworks.selenium.Selenium;

public class CreateVisitTypeUSView extends AbstractSchedulingTest {
	

	@Test(groups = {"RegressionUS","Review","firefox", "iexplore", "safari", "default" , "BeforePortVisitGroup"}, description = "CreateNewVisitType If Required")
	@Parameters( { "seleniumHost", "seleniumPort", "browser", "webSite", "userAccount"})
	public void createNewVisitType001(String seleniumHost, int seleniumPort,String browser, String webSite, String userAccount)throws Exception {
		SchedulingTestLib visitType = new SchedulingTestLib();
		visitType.workSheetName = "PortCreateVisitTypeUSView";
		visitType.testCaseId = "TC_CVT_001";
		visitType.fetchSchedulingTestData();
		checkVisitType(seleniumHost, seleniumPort, browser, webSite, userAccount, visitType);
  }	

	@Test(groups = {"RegressionUS","Review","firefox", "iexplore", "safari", "default" , "BeforePortVisitGroup"}, description = "CreateNewVisitType If Required")
	@Parameters( { "seleniumHost", "seleniumPort", "browser", "webSite", "userAccount"})
	public void createNewVisitType002(String seleniumHost, int seleniumPort,String browser, String webSite, String userAccount)throws Exception {
		SchedulingTestLib visitType = new SchedulingTestLib();
		visitType.workSheetName = "PortCreateVisitTypeUSView";
		visitType.testCaseId = "TC_CVT_002";
		visitType.fetchSchedulingTestData();
		checkVisitType(seleniumHost, seleniumPort, browser, webSite, userAccount, visitType);
  }	

	@Test(groups = {"RegressionUS","Review","firefox", "iexplore", "safari", "default" , "BeforePortVisitGroup"}, description = "CreateNewVisitType If Required")
	@Parameters( { "seleniumHost", "seleniumPort", "browser", "webSite", "userAccount"})
	public void createNewVisitType003(String seleniumHost, int seleniumPort,String browser, String webSite, String userAccount)throws Exception {
		SchedulingTestLib visitType = new SchedulingTestLib();
		visitType.workSheetName = "PortCreateVisitTypeUSView";
		visitType.testCaseId = "TC_CVT_003";
		visitType.fetchSchedulingTestData();
		checkVisitType(seleniumHost, seleniumPort, browser, webSite, userAccount, visitType);
  }	

	@Test(groups = {"RegressionUS","Review","firefox", "iexplore", "safari", "default" , "BeforePortVisitGroup"}, description = "CreateNewVisitType If Required")
	@Parameters( { "seleniumHost", "seleniumPort", "browser", "webSite", "userAccount"})
	public void createNewVisitType004(String seleniumHost, int seleniumPort,String browser, String webSite, String userAccount)throws Exception {
		SchedulingTestLib visitType = new SchedulingTestLib();
		visitType.workSheetName = "PortCreateVisitTypeUSView";
		visitType.testCaseId = "TC_CVT_004";
		visitType.fetchSchedulingTestData();
		checkVisitType(seleniumHost, seleniumPort, browser, webSite, userAccount, visitType);
  }	
	

	@Test(groups = {"RegressionUS","Review","firefox", "iexplore", "safari", "default" , "BeforePortVisitGroup"}, description = "CreateNewVisitType If Required")
	@Parameters( { "seleniumHost", "seleniumPort", "browser", "webSite", "userAccount"})
	public void createNewVisitType005(String seleniumHost, int seleniumPort,String browser, String webSite, String userAccount)throws Exception {
		SchedulingTestLib visitType = new SchedulingTestLib();
		visitType.workSheetName = "PortCreateVisitTypeUSView";
		visitType.testCaseId = "TC_CVT_005";
		visitType.fetchSchedulingTestData();
		checkVisitType(seleniumHost, seleniumPort, browser, webSite, userAccount, visitType);
  }	

	@Test(groups = {"RegressionUS","Review","firefox", "iexplore", "safari", "default" , "BeforePortVisitGroup"}, description = "CreateNewVisitType If Required")
	@Parameters( { "seleniumHost", "seleniumPort", "browser", "webSite", "userAccount"})
	public void createNewVisitType006(String seleniumHost, int seleniumPort,String browser, String webSite, String userAccount)throws Exception {
		SchedulingTestLib visitType = new SchedulingTestLib();
		visitType.workSheetName = "PortCreateVisitTypeUSView";
		visitType.testCaseId = "TC_CVT_006";
		visitType.fetchSchedulingTestData();
		checkVisitType(seleniumHost, seleniumPort, browser, webSite, userAccount, visitType);
  }	

	@Test(groups = {"RegressionUS","Review","firefox", "iexplore", "safari", "default" , "BeforePortVisitGroup"}, description = "CreateNewVisitType If Required")
	@Parameters( { "seleniumHost", "seleniumPort", "browser", "webSite", "userAccount"})
	public void createNewVisitType007(String seleniumHost, int seleniumPort,String browser, String webSite, String userAccount)throws Exception {
		SchedulingTestLib visitType = new SchedulingTestLib();
		visitType.workSheetName = "PortCreateVisitTypeUSView";
		visitType.testCaseId = "TC_CVT_007";
		visitType.fetchSchedulingTestData();
		checkVisitType(seleniumHost, seleniumPort, browser, webSite, userAccount, visitType);
  }	

	@Test(groups = {"RegressionUS","Review","firefox", "iexplore", "safari", "default" , "BeforePortVisitGroup"}, description = "CreateNewVisitType If Required")
	@Parameters( { "seleniumHost", "seleniumPort", "browser", "webSite", "userAccount"})
	public void createNewVisitType008(String seleniumHost, int seleniumPort,String browser, String webSite, String userAccount)throws Exception {
		SchedulingTestLib visitType = new SchedulingTestLib();
		visitType.workSheetName = "PortCreateVisitTypeUSView";
		visitType.testCaseId = "TC_CVT_008";
		visitType.fetchSchedulingTestData();
		checkVisitType(seleniumHost, seleniumPort, browser, webSite, userAccount, visitType);
  }	
	@Test(groups = {"RegressionUS","Review","firefox", "iexplore", "safari", "default" , "BeforePortVisitGroup"}, description = "CreateNewVisitType If Required")
	@Parameters( { "seleniumHost", "seleniumPort", "browser", "webSite", "userAccount"})
	public void createNewVisitType009(String seleniumHost, int seleniumPort,String browser, String webSite, String userAccount)throws Exception {
		SchedulingTestLib visitType = new SchedulingTestLib();
		visitType.workSheetName = "PortCreateVisitTypeUSView";
		visitType.testCaseId = "TC_CVT_008";
		visitType.fetchSchedulingTestData();
		checkVisitType(seleniumHost, seleniumPort, browser, webSite, userAccount, visitType);
  }	
	/*************************************************************************************************** 
	* @purpose        To verify create New Visit Type
	* @action 		  verifying Create Function  for Visit Type 
	* @author         Aspire QA
	* @state          Developing
	* @useraccount    Both (US and Canada)
	* @since  	      Jun 19, 2013
	***************************************************************************************************/
	
	
	 public boolean checkVisitType(String seleniumHost, int seleniumPort,String browser, String webSite, String userAccount, SchedulingTestLib visitType) throws Exception{
			
		    Selenium selenium = null;
			
		   	try {
			
				//--------------------------------------------------------------------//
				//  Step-1: Login to the application
				//--------------------------------------------------------------------//
				selenium = getSession(seleniumHost, seleniumPort, browser, webSite);
				Assert.assertNotNull(selenium,"Could Not Retrive the New Selenium Session; More Details :" + visitType.toString());
				assertTrue(loginForNexiaFromPublicSite(selenium, userAccount, visitType.userName, visitType.userPassword),"Login Failed ",selenium,ClassName,MethodName);
				
				//--------------------------------------------------------------------//
				//  Step-2:Change Switch Role  										  //
				//--------------------------------------------------------------------//
				assertTrue(switchRole(selenium,visitType.switchRole),"Couldnt change switch role",selenium,ClassName,MethodName);
				waitForPageLoad(selenium);
				
				
				//--------------------------------------------------------------------//
				//  Step-2:Change Switch Practice										  //
				//--------------------------------------------------------------------//
				 assertTrue(click(selenium,lnkTopPracticeMenu),"Could not click on practice menu",selenium,ClassName,MethodName);
				 waitForPageLoad(selenium);
				 int count=1;
				 while(isElementPresent(selenium,"//tr["+count+"]/td/a/span")){
					 if(getText(selenium,"//tr["+count+"]/td/a/span").contains(visitType.practiceName)){
					 click(selenium,"//tr["+count+"]/td/a/span");
					 waitForPageLoad(selenium);
					 }
					 else{
						 count++;
					 }
					 
					 if(count>15){
						 break;
					 }
				 }
				
				//--------------------------------------------------------------------//
				//  Step-3:Navigate to Scheduling section							  //
				//--------------------------------------------------------------------//
		
				assertTrue(click(selenium,lnkQuickAction),"Could not click the link",selenium,ClassName,MethodName);
				waitForPageLoad(selenium);
				assertTrue(isElementPresent(selenium,lnkScheduling),"Could not find the Scheduling link",selenium,ClassName,MethodName);
				assertTrue(click(selenium,lnkScheduling),"Could not click Scheduling link",selenium,ClassName,MethodName);
				waitForPageLoad(selenium);
				
				//--------------------------------------------------------------------//
				//  Step-4:Navigate to Visit Type							          //
				//--------------------------------------------------------------------//
				assertTrue(click(selenium,lnkVisitType),"could not click the Visit Type Link",selenium,ClassName,MethodName);
				waitForPageLoad(selenium);
				
				//--------------------------------------------------------------------//
				//  Step-5: Search Visit Type					          //
				//--------------------------------------------------------------------//
				
				  if(!(searchVisitType(selenium, visitType.visitName))){
					  System.out.println("Visit Type Already Exists");
					 
				
				  }else{
					   
					   System.out.println("New Visit Type");
					   
					   createVisitTypeUSView(selenium,visitType);
					   waitForPageLoad(selenium);
					   assertTrue(type(selenium,txtSearchType,visitType.visitName),"Could not Type the visit name",selenium,ClassName,MethodName);
					   waitForPageLoad(selenium);
					   selenium.keyPress(txtSearchType, "\\13");
					   waitForPageLoad(selenium);
				
				  }
				
					
					//--------------------------------------------------------------------//
					//  Step-6: Verify Visit Type Details					              //
					//--------------------------------------------------------------------//

				    if(!(verifyVisitTypeDetails(selenium,visitType))){
				    	Assert.fail("The Verify Visit Type Details are not stored properly ");
				    	
				    	
				    }
				  
			}
			
			catch (RuntimeException e ){
				
				e.printStackTrace();
				Assert.fail("Failed Due to the Exception; \n\t*) ExceptionDetails :"+e.getMessage()+"\n\t*); Detailed data:" + visitType.toString());
			}
			
			return true;
			}
	 
	 
	   public boolean searchVisitType(Selenium selenium, String visitName) throws IOException{
		 
		   boolean returnValue = false;
			
		    //--------------------------------------------------------------------//
			//   Search Visit Type					                              //
			//--------------------------------------------------------------------//
		    assertTrue(type(selenium,txtSearchType,visitName),"Could not Type the visit name",selenium,ClassName,MethodName);
			waitForPageLoad(selenium);
			selenium.keyPress(txtSearchType, "\\13");
		
		   
			if(getText(selenium, lblSummaryVisitDetails).contains(visitName)){
				System.out.println("Visit Type - " + visitName + " is already created, No More Work");
			 }else if(!isChecked(selenium,chkIncludeInactiveVisitType)){
			     assertTrue(click(selenium,chkIncludeInactiveVisitType),"Could not click IncludeInactiveCheckbox",selenium,ClassName,MethodName);
			
				 if(getText(selenium, lblSummaryVisitDetails).contains(visitName)){
						System.out.println("Visit Type - " + visitName + " is already created With Inactive, No More Work");
						 assertTrue(click(selenium,lnkActivateCalendarTemplate),"Could not click Active",selenium,ClassName,MethodName);
						 waitForPageLoad(selenium);
						 assertTrue(click(selenium,btnYes),"Could not click Yes button",selenium,ClassName,MethodName);
						 waitForPageLoad(selenium);
				}
				 else {
						System.out.println("Visit Type - " + visitName + "  Not created,  create a new Visit Type");
						return true;
					}
			 }else {
				System.out.println("Visit Type - " + visitName + "  Not created,  create a new Visit Type");
				return true;
			}
		   
		   return returnValue;
	 }
	   
	
	   
	   
	   public boolean  createVisitTypeUSView(Selenium selenium, SchedulingTestLib visitType) throws IOException{
		  
		   boolean returnValue = false;
		   
		   try{
			assertTrue(click(selenium,btnAdd),"Could not click on add new button",selenium,ClassName,MethodName);
			waitForPageLoad(selenium);
			
			assertTrue(type(selenium,txtvisitType,visitType.visitName),"Could not enter the visit Name",selenium,ClassName,MethodName);
			waitForPageLoad(selenium);
			
			assertTrue(type(selenium,txtduration,visitType.duration),"Could not enter the duration",selenium,ClassName,MethodName);
			waitForPageLoad(selenium);
		
			assertTrue(selectValueFromAjaxList(selenium,ajxVisitModel,visitType.visitModel),"Could not select the model",selenium,ClassName,MethodName);
			waitForPageLoad(selenium);
			
			if(!(visitType.testCaseId.equals("TC_CVT_007")||visitType.testCaseId.equals("TC_CVT_008"))){
			  if(!isChecked(selenium,chkAllowMultiple)){
				assertTrue(click(selenium,chkAllowMultiple),"Could not click the allow multiple check box",selenium,ClassName,MethodName);
			  }
			  if(!isChecked(selenium,chkUnLimted)){
					assertTrue(click(selenium,chkUnLimted),"Could not click the unlimited radio button",selenium,ClassName,MethodName);
			  }
			}
		
			if(visitType.testCaseId.equals("TC_CVT_009")){
				if(getText(selenium,"link=More Options").equalsIgnoreCase("More Options")){
					assertTrue(click(selenium,"link=More Options"),"Could not click the More Option" ,selenium,ClassName,MethodName);
				}
				
				if(!isChecked(selenium,"visitTypeConfirmcheckbox")){
					assertTrue(click(selenium,"visitTypeConfirmcheckbox"),"Could not click the More Option" ,selenium,ClassName,MethodName);
				}
				assertTrue(type(selenium,"confirmationDays","3"),"could not enter the value",selenium,ClassName,MethodName);
				
			}
			
			if(visitType.testCaseId.equals("TC_CVT_001")){
				assertTrue(click(selenium,lblDarkBlueColour),"Could not click the dark blue color box",selenium,ClassName,MethodName);
			}
			
			else if(visitType.testCaseId.equals("TC_CVT_002")){
				assertTrue(click(selenium,lblLightBlueColour),"Could not click the light blue color box",selenium,ClassName,MethodName);
			}
			
			else if(visitType.testCaseId.equals("TC_CVT_003")){
				assertTrue(click(selenium,lblPinkColour),"Could not click the Pink color box",selenium,ClassName,MethodName);
			}
			
			else if(visitType.testCaseId.equals("TC_CVT_004")){
				assertTrue(click(selenium,lblRedColour),"Could not click the Red color box",selenium,ClassName,MethodName);
			}
			
			else if(visitType.testCaseId.equals("TC_CVT_008")){
				assertTrue(click(selenium,lblYellowColour),"Could not click the Yellow color box",selenium,ClassName,MethodName);
			}
			
			assertTrue(click(selenium,btnSave),"could not click on save button",selenium,ClassName,MethodName);
			waitForPageLoad(selenium);
		   }
		   
		   catch (RuntimeException e ) {
			    e.printStackTrace();
				Assert.fail("Failed Due to the Exception; \n\t*) ExceptionDetails :"+e.getMessage()+"\n\t*); Detailed data:" + visitType.toString());
		   }
		   
		   return returnValue;
	   }
	 
	   
	   
	   public boolean  verifyVisitTypeDetails(Selenium selenium, SchedulingTestLib visitType) throws IOException{
 		   boolean returnValue = true; 
		   String color= selenium.getAttribute(lblcolor+"@style");
			System.out.println(color);
			if(visitType.testCaseId.equals("TC_CVT_001")){
				if(color.trim().contains("rgb(47, 109, 199)".trim()))
					returnValue = true;
				else
					Assert.fail("color is not getting displayed");
			}
			
			else if(visitType.testCaseId.equals("TC_CVT_002")){
				if(color.trim().contains("rgb(153, 204, 255)".trim()))
					returnValue = true;
				else
					Assert.fail("color is not getting displayed");
			}
			else if(visitType.testCaseId.equals("TC_CVT_003")){
				if(color.trim().contains("rgb(160, 62, 169)".trim()))
					returnValue = true;
				else
					Assert.fail("color is not getting displayed");
			}
			else if(visitType.testCaseId.equals("TC_CVT_004")){
				if(color.trim().contains("rgb(255, 102, 102)".trim()))
					returnValue = true;
				else
					Assert.fail("color is not getting displayed");
			}
			else if(visitType.testCaseId.equals("TC_CVT_008")){
				if(color.trim().contains("rgb(255, 204, 102)".trim()))
					returnValue = true;
				else
					Assert.fail("color is not getting displayed");
			}
		   
		   
		   assertTrue(click(selenium,btnEdit),"Could not click on edit button",selenium,ClassName,MethodName);
		  					  
				 
			 if(!(visitType.testCaseId.equals("TC_CVT_007")||visitType.testCaseId.equals("TC_CVT_008"))){
				  if(!isChecked(selenium,chkAllowMultiple)){
					  returnValue = false; 
     				    }
				}else{
					 if(isChecked(selenium,chkAllowMultiple)){
						 returnValue = false;
	     
					    }
				}
		   
		   return returnValue;
	   }
	 }
	

